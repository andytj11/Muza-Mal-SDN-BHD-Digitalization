{
  "gitSyncId": "689d89d0c8cfcc46e1c3653b_7efd92dd-494a-41cc-b7fc-6e4ddf27e8aa",
  "id": "Create Finding_ObservationForms_InsertOne",
  "pluginId": "google-sheets-plugin",
  "pluginType": "SAAS",
  "unpublishedAction": {
    "actionConfiguration": {
      "encodeParamsToggle": true,
      "formData": {
        "command": {
          "data": "INSERT_ONE"
        },
        "entityType": {
          "data": "ROWS"
        },
        "pagination": {
          "data": {
            "limit": "20",
            "offset": "0"
          }
        },
        "projection": {
          "data": []
        },
        "queryFormat": {
          "data": "ROWS"
        },
        "range": {
          "data": ""
        },
        "rowObjects": {
          "data": "{{\n(() => {\n  // always make findings date same as submitted date\n  const submitted = moment().format('YYYY-MM-DD');\n  const findings  = submitted;\n\n  const forms = ObservationForms_GetAll.data || [];\n  const newFormId = appsmith.store.new_form_id || IssueHelpers.nextFormId(forms);\n  const obsNo     = IssueHelpers.newObservationNo(forms);\n  const obsCode   = IssueHelpers.nextObservationCode(forms);\n\n  const deptName  = DepartmentSelect.selectedOptionLabel || DepartmentSelect.text || \"\";\n  const sourceCsv = IssueHelpers.sourcesCsv();\n\n  const issued    = IssueHelpers.selectedUserFrom(IssuedBySelect);\n  const reviewer  = IssueHelpers.selectedUserFrom(ReviewedBySelect);\n  const approver  = IssueHelpers.selectedUserFrom(ApprovedBySelect);\n  const assigned  = IssueHelpers.selectedUserFrom(AssignedToSelect);\n  const attention = IssueHelpers.selectedUserFrom(AttentionToSelect);\n\n  // compute 7 working days after SUBMITTED date\n  const due = Utils.addWorkingDays(submitted, 7, Holidays_GetAll.data);\n  const dueFmt = moment(due).format('YYYY-MM-DD');\n\n  return {\n    form_id: newFormId,\n    observation_no: obsNo,\n    observation_code_pdf: obsCode,\n    document_no: \"MUZ-FM-AUD-002\",\n    revision: 6,\n    effective_date: \"2024-11-26\",\n\n    date_of_findings: findings,             // == date_submitted\n    date_submitted: submitted,\n    plan_reply_due_date: dueFmt,\n\n    department_name: deptName,\n    observation_source: sourceCsv,\n\n    issued_by_user_id: issued.id,\n    issued_by_name: issued.name,\n\n    reviewer_user_id: reviewer.id,\n    reviewer_name: reviewer.name,\n\n    approver_user_id: approver.id,\n    approver_name: approver.name,\n\n    assigned_to_user_id: assigned.id,\n    assigned_to_name: assigned.name,\n\n    attention_to_user_id: attention.id,\n    attention_to_name: attention.name,\n\n    status: \"OPEN\",\n    ofi_plan_received_date: \"\",\n    ofi_evidence_received_date: \"\",\n\n    findings_summary: (FindingsInput.text || \"\").trim()\n  };\n})()\n}}\n"
        },
        "sheetName": {
          "data": "observationforms"
        },
        "sheetUrl": {
          "data": "https://docs.google.com/spreadsheets/d/1p9qzLiq77vTqP-EGtmptV1VZiqKRWg75Slm-gUfDTDQ/edit"
        },
        "smartSubstitution": {
          "data": true
        },
        "tableHeaderIndex": {
          "data": "1"
        },
        "where": {
          "data": {
            "condition": "AND"
          }
        }
      },
      "paginationType": "NONE",
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "GS_FormWorkflow",
      "isAutoGenerated": false,
      "name": "GS_FormWorkflow",
      "pluginId": "google-sheets-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "formData.rowObjects.data"
      }
    ],
    "name": "ObservationForms_InsertOne",
    "pageId": "Create Finding",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}